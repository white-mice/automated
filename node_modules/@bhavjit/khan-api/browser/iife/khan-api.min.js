/**
 * Khan API v0.5.4
 * https://khan-api.bhavjit.com
 * Licensed under MIT license
 * Copyright 2023 Bhavjit Chauhan
 */

"use strict";var KhanAPI=(()=>{var tt=Object.create;var De=Object.defineProperty;var at=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var st=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty;var it=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),sr=(t,r)=>{for(var e in r)De(t,e,{get:r[e],enumerable:!0})},Cr=(t,r,e,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of ot(r))!nt.call(t,s)&&s!==e&&De(t,s,{get:()=>r[s],enumerable:!(a=at(r,s))||a.enumerable});return t};var lt=(t,r,e)=>(e=t!=null?tt(st(t)):{},Cr(r||!t||!t.__esModule?De(e,"default",{value:t,enumerable:!0}):e,t)),dt=t=>Cr(De({},"__esModule",{value:!0}),t);var nr=(t,r,e)=>{if(!r.has(t))throw TypeError("Cannot "+e)};var m=(t,r,e)=>(nr(t,r,"read from private field"),e?e.call(t):r.get(t)),K=(t,r,e)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,e)},Le=(t,r,e,a)=>(nr(t,r,"write to private field"),a?a.call(t,e):r.set(t,e),e);var f=(t,r,e)=>(nr(t,r,"access private method"),e);var qr=it((Q,Lr)=>{var Dr=typeof self<"u"?self:Q,qe=function(){function t(){this.fetch=!1,this.DOMException=Dr.DOMException}return t.prototype=Dr,new t}();(function(t){var r=function(e){var a={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function s(o){return o&&DataView.prototype.isPrototypeOf(o)}if(a.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(o){return o&&i.indexOf(Object.prototype.toString.call(o))>-1};function y(o){if(typeof o!="string"&&(o=String(o)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(o))throw new TypeError("Invalid character in header field name");return o.toLowerCase()}function E(o){return typeof o!="string"&&(o=String(o)),o}function O(o){var n={next:function(){var l=o.shift();return{done:l===void 0,value:l}}};return a.iterable&&(n[Symbol.iterator]=function(){return n}),n}function p(o){this.map={},o instanceof p?o.forEach(function(n,l){this.append(l,n)},this):Array.isArray(o)?o.forEach(function(n){this.append(n[0],n[1])},this):o&&Object.getOwnPropertyNames(o).forEach(function(n){this.append(n,o[n])},this)}p.prototype.append=function(o,n){o=y(o),n=E(n);var l=this.map[o];this.map[o]=l?l+", "+n:n},p.prototype.delete=function(o){delete this.map[y(o)]},p.prototype.get=function(o){return o=y(o),this.has(o)?this.map[o]:null},p.prototype.has=function(o){return this.map.hasOwnProperty(y(o))},p.prototype.set=function(o,n){this.map[y(o)]=E(n)},p.prototype.forEach=function(o,n){for(var l in this.map)this.map.hasOwnProperty(l)&&o.call(n,this.map[l],l,this)},p.prototype.keys=function(){var o=[];return this.forEach(function(n,l){o.push(l)}),O(o)},p.prototype.values=function(){var o=[];return this.forEach(function(n){o.push(n)}),O(o)},p.prototype.entries=function(){var o=[];return this.forEach(function(n,l){o.push([l,n])}),O(o)},a.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function v(o){if(o.bodyUsed)return Promise.reject(new TypeError("Already read"));o.bodyUsed=!0}function ge(o){return new Promise(function(n,l){o.onload=function(){n(o.result)},o.onerror=function(){l(o.error)}})}function he(o){var n=new FileReader,l=ge(n);return n.readAsArrayBuffer(o),l}function ie(o){var n=new FileReader,l=ge(n);return n.readAsText(o),l}function h(o){for(var n=new Uint8Array(o),l=new Array(n.length),P=0;P<n.length;P++)l[P]=String.fromCharCode(n[P]);return l.join("")}function z(o){if(o.slice)return o.slice(0);var n=new Uint8Array(o.byteLength);return n.set(new Uint8Array(o)),n.buffer}function be(){return this.bodyUsed=!1,this._initBody=function(o){this._bodyInit=o,o?typeof o=="string"?this._bodyText=o:a.blob&&Blob.prototype.isPrototypeOf(o)?this._bodyBlob=o:a.formData&&FormData.prototype.isPrototypeOf(o)?this._bodyFormData=o:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)?this._bodyText=o.toString():a.arrayBuffer&&a.blob&&s(o)?(this._bodyArrayBuffer=z(o.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(o)||d(o))?this._bodyArrayBuffer=z(o):this._bodyText=o=Object.prototype.toString.call(o):this._bodyText="",this.headers.get("content-type")||(typeof o=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var o=v(this);if(o)return o;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var o=v(this);if(o)return o;if(this._bodyBlob)return ie(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(h(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(Xr)}),this.json=function(){return this.text().then(JSON.parse)},this}var zr=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Zr(o){var n=o.toUpperCase();return zr.indexOf(n)>-1?n:o}function Z(o,n){n=n||{};var l=n.body;if(o instanceof Z){if(o.bodyUsed)throw new TypeError("Already read");this.url=o.url,this.credentials=o.credentials,n.headers||(this.headers=new p(o.headers)),this.method=o.method,this.mode=o.mode,this.signal=o.signal,!l&&o._bodyInit!=null&&(l=o._bodyInit,o.bodyUsed=!0)}else this.url=String(o);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new p(n.headers)),this.method=Zr(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&l)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(l)}Z.prototype.clone=function(){return new Z(this,{body:this._bodyInit})};function Xr(o){var n=new FormData;return o.trim().split("&").forEach(function(l){if(l){var P=l.split("="),w=P.shift().replace(/\+/g," "),c=P.join("=").replace(/\+/g," ");n.append(decodeURIComponent(w),decodeURIComponent(c))}}),n}function et(o){var n=new p,l=o.replace(/\r?\n[\t ]+/g," ");return l.split(/\r?\n/).forEach(function(P){var w=P.split(":"),c=w.shift().trim();if(c){var Fe=w.join(":").trim();n.append(c,Fe)}}),n}be.call(Z.prototype);function M(o,n){n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new p(n.headers),this.url=n.url||"",this._initBody(o)}be.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},M.error=function(){var o=new M(null,{status:0,statusText:""});return o.type="error",o};var rt=[301,302,303,307,308];M.redirect=function(o,n){if(rt.indexOf(n)===-1)throw new RangeError("Invalid status code");return new M(null,{status:n,headers:{location:o}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(n,l){this.message=n,this.name=l;var P=Error(n);this.stack=P.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function ar(o,n){return new Promise(function(l,P){var w=new Z(o,n);if(w.signal&&w.signal.aborted)return P(new e.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function Fe(){c.abort()}c.onload=function(){var ke={status:c.status,statusText:c.statusText,headers:et(c.getAllResponseHeaders()||"")};ke.url="responseURL"in c?c.responseURL:ke.headers.get("X-Request-URL");var or="response"in c?c.response:c.responseText;l(new M(or,ke))},c.onerror=function(){P(new TypeError("Network request failed"))},c.ontimeout=function(){P(new TypeError("Network request failed"))},c.onabort=function(){P(new e.DOMException("Aborted","AbortError"))},c.open(w.method,w.url,!0),w.credentials==="include"?c.withCredentials=!0:w.credentials==="omit"&&(c.withCredentials=!1),"responseType"in c&&a.blob&&(c.responseType="blob"),w.headers.forEach(function(ke,or){c.setRequestHeader(or,ke)}),w.signal&&(w.signal.addEventListener("abort",Fe),c.onreadystatechange=function(){c.readyState===4&&w.signal.removeEventListener("abort",Fe)}),c.send(typeof w._bodyInit>"u"?null:w._bodyInit)})}return ar.polyfill=!0,t.fetch||(t.fetch=ar,t.Headers=p,t.Request=Z,t.Response=M),e.Headers=p,e.Request=Z,e.Response=M,e.fetch=ar,Object.defineProperty(e,"__esModule",{value:!0}),e}({})})(qe);qe.fetch.ponyfill=!0;delete qe.fetch.polyfill;var le=qe;Q=le.fetch;Q.default=le.fetch;Q.fetch=le.fetch;Q.Headers=le.Headers;Q.Request=le.Request;Q.Response=le.Response;Lr.exports=Q});var Kt={};sr(Kt,{Answer:()=>V,BaseMessage:()=>j,Client:()=>u,EmailRegex:()=>br,EmailRegexMatch:()=>Pt,FeedbackFocusKind:()=>ze,FeedbackKeyRegex:()=>yr,FeedbackKeyRegexMatch:()=>bt,FeedbackSort:()=>Rr,FeedbackType:()=>Te,FeedbackTypename:()=>Hr,GoogleIDRegex:()=>Re,GoogleIDRegexMatch:()=>wt,KaidRegex:()=>Oe,KaidRegexMatch:()=>ut,ListProgramSortOrder:()=>Pr,MESSAGE_ENCRYPTED_KEY_LENGTHS:()=>kt,MESSAGE_KEY_LENGTHS:()=>ht,Message:()=>g,MessageEncryptedKeyRegex:()=>fr,MessageEncryptedKeyRegexMatch:()=>_t,MessageType:()=>oe,PROGRAM_ID_LENGTHS:()=>Nr,PROGRAM_KEY_LENGTHS:()=>Or,PROGRAM_URL_PATHS:()=>cr,Program:()=>T,ProgramEditorType:()=>wr,ProgramIDRegex:()=>Qe,ProgramIDRegexMatch:()=>pr,ProgramImagePathRegex:()=>we,ProgramImagePathRegexMatch:()=>ft,ProgramKeyRegex:()=>mr,ProgramKeyRegexMatch:()=>gt,ProgramType:()=>Ir,ProgramURLRegex:()=>ee,ProgramURLRegexMatch:()=>yt,QualarooIDRegex:()=>Pe,QualarooIDRegexMatch:()=>Rt,Question:()=>x,Reply:()=>L,ServiceErrorCode:()=>Qr,ServiceErrorName:()=>$r,TipsAndThanks:()=>C,TypeToClass:()=>Tr,URL_LOCALES:()=>dr,URL_TLDS:()=>lr,User:()=>D,UserAccessLevel:()=>Gr,UserURLRegex:()=>ce,UserURLRegexMatch:()=>mt,assertDataResponse:()=>S,avatarNameToSlug:()=>xt,avatarNames:()=>Ar,avatarSlugToName:()=>Et,avatarSlugs:()=>Ur,convertAvatarPNGToSVG:()=>At,convertAvatarSVGToPNG:()=>It,extractAvatarSlug:()=>Ce,generateAvatarPNG:()=>rr,generateAvatarSVG:()=>er,isAnswerSchema:()=>vt,isDataResponse:()=>jr,isEmail:()=>A,isEncryptedFeedbackKey:()=>I,isFeedbackKey:()=>R,isGoogleID:()=>gr,isInputErrorResponse:()=>Yr,isKaid:()=>_,isProgramID:()=>Y,isProgramKey:()=>re,isProgramURL:()=>ur,isQualarooID:()=>hr,isQuestionSchema:()=>Kr,isReplySchema:()=>Ut,isServiceErrorsResponse:()=>Wr,isTipsAndThanksSchema:()=>vr,isUserURL:()=>X,mutations:()=>_r,programIDtoKey:()=>St,programKeyToID:()=>Sr,queries:()=>kr,resolveFeedbackKey:()=>Er,resolveKaid:()=>Xe,resolveProgramID:()=>me,resolveUsername:()=>xr});var kr={};sr(kr,{AvatarDataForProfile:()=>Me,FeedbackQuery:()=>Be,GetFeedbackReplies:()=>Ve,GetFullUserProfile:()=>$e,GetProfileWidgets:()=>Ge,GetUserByUsernameOrEmail:()=>He,GetUserHoverCardProfile:()=>je,ProgramQuery:()=>We,ProjectsAuthoredByUser:()=>Ye,QAExpandKeyInfo:()=>ve,QaExpandKeyInfo:()=>Je,avatarDataForProfile:()=>_e,feedbackQuery:()=>de,getFeedbackReplies:()=>pe,getFullUserProfile:()=>Se,getProfileWidgets:()=>xe,getUserByUsernameOrEmail:()=>Ee,getUserHoverCardProfile:()=>Ie,programQuery:()=>Ae,projectsAuthoredByUser:()=>Ue});var b="https://www.khanacademy.org/api/internal/graphql",ir=`bhavjitchauhan/khan-api_${Date.now()}`,Fr=4669512406581248;var Mr=lt(qr(),1);async function pt(t,r){return await(0,Mr.default)(t,r)}async function ct(t,r,e){return e={method:"post",body:JSON.stringify(r),...e},await pt(t,e)}async function k(t,r,e={},a){return await ct(t,{query:r,variables:e},a)}var Me;(r=>r.query=`query avatarDataForProfile($kaid: String!) {
  user(kaid: $kaid) {
    id
    avatar {
      name
      imageSrc
      __typename
    }
    __typename
  }
}
`)(Me||(Me={}));function _e(t,r){return k(`${b}/avatarDataForProfile`,Me.query,typeof t=="string"?{kaid:t}:t,r)}var Be;(r=>r.query=`query feedbackQuery($topicId: String!, $focusKind: String!, $cursor: String, $limit: Int, $feedbackType: FeedbackType!, $currentSort: Int, $qaExpandKey: String) {
  feedback(focusId: $topicId, cursor: $cursor, limit: $limit, feedbackType: $feedbackType, focusKind: $focusKind, sort: $currentSort, qaExpandKey: $qaExpandKey, answersLimit: 1) {
    feedback {
      isLocked
      replyCount
      appearsAsDeleted
      author {
        id
        kaid
        nickname
        avatar {
          name
          imageSrc
          __typename
        }
        __typename
      }
      badges {
        name
        icons {
          smallUrl
          __typename
        }
        description
        __typename
      }
      content
      date
      definitelyNotSpam
      deleted
      downVoted
      expandKey
      feedbackType
      flaggedBy
      flaggedByUser
      flags
      focusUrl
      focus {
        kind
        id
        translatedTitle
        relativeUrl
        __typename
      }
      fromVideoAuthor
      key
      lowQualityScore
      notifyOnAnswer
      permalink
      qualityKind
      replyCount
      replyExpandKeys
      showLowQualityNotice
      sumVotesIncremented
      upVoted
      ... on QuestionFeedback {
        hasAnswered
        answers {
          replyCount
          appearsAsDeleted
          author {
            id
            kaid
            nickname
            avatar {
              name
              imageSrc
              __typename
            }
            __typename
          }
          badges {
            name
            icons {
              smallUrl
              __typename
            }
            description
            __typename
          }
          content
          date
          definitelyNotSpam
          deleted
          downVoted
          expandKey
          feedbackType
          flaggedBy
          flaggedByUser
          flags
          focusUrl
          focus {
            kind
            id
            translatedTitle
            relativeUrl
            __typename
          }
          fromVideoAuthor
          key
          lowQualityScore
          notifyOnAnswer
          permalink
          qualityKind
          replyCount
          replyExpandKeys
          showLowQualityNotice
          sumVotesIncremented
          upVoted
          __typename
        }
        isOld
        answerCount
        __typename
      }
      ... on AnswerFeedback {
        question {
          replyCount
          appearsAsDeleted
          author {
            id
            kaid
            nickname
            avatar {
              name
              imageSrc
              __typename
            }
            __typename
          }
          badges {
            name
            icons {
              smallUrl
              __typename
            }
            description
            __typename
          }
          content
          date
          definitelyNotSpam
          deleted
          downVoted
          expandKey
          feedbackType
          flaggedBy
          flaggedByUser
          flags
          focusUrl
          focus {
            kind
            id
            translatedTitle
            relativeUrl
            __typename
          }
          fromVideoAuthor
          key
          lowQualityScore
          notifyOnAnswer
          permalink
          qualityKind
          replyCount
          replyExpandKeys
          showLowQualityNotice
          sumVotesIncremented
          upVoted
          __typename
        }
        __typename
      }
      __typename
    }
    cursor
    isComplete
    sortedByDate
    __typename
  }
}
`)(Be||(Be={}));function de(t,r){return k(`${b}/feedbackQuery`,Be.query,t,r)}var Ve;(r=>r.query=`query getFeedbackReplies($postKey: String!) {
  feedbackReplies(feedbackKey: $postKey) {
    isLocked
    expandKey
    appearsAsDeleted
    author {
      id
      kaid
      nickname
      avatar {
        name
        imageSrc
        __typename
      }
      __typename
    }
    content
    date
    definitelyNotSpam
    deleted
    downVoted
    expandKey
    feedbackType
    flaggedBy
    flaggedByUser
    flags
    focusUrl
    fromVideoAuthor
    key
    lowQualityScore
    notifyOnAnswer
    permalink
    qualityKind
    replyCount
    replyExpandKeys
    showLowQualityNotice
    sumVotesIncremented
    upVoted
    __typename
  }
}
`)(Ve||(Ve={}));function pe(t,r){return k(`${b}/getFeedbackReplies`,Ve.query,typeof t=="string"?{postKey:t}:t,r)}function Br(t,r,e="..."){return r=Math.max(0,r),t.length>r?t.slice(0,r-e.length)+e:t}function Ne(t){return t.replace(/-/g,"+").replace(/_/g,"/")}function Vr(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function B(t){return new RegExp(`(${t.source.slice(1,-1)})`)}var lr=["com","org"],dr=["as","az","cs","da","el","gu","hu","id","it","lt","ja","kk","kn","ky","lv","mn","mr","my","nl","pt-pt","ru","sv","ta","uz","bg","bn","de","en","es","fr","hi","hy","ka","km","ko","nb","pa","pl","pt","ro","sr","tr","vi","zh-hans","sgn-us"],Oe=/^kaid_\d{20,25}$/,ut=B(Oe),_=t=>Oe.test(t),ce=new RegExp(`^https?:\\/\\/(?:(?:www|${dr.join("|")})\\.)?khanacademy\\.(?:${lr.join("|")})\\/profile\\/((?!kaid_|kaid_\\D)\\w+|(?:${Oe.toString().slice(2,-2)}))(?:\\/.*)?$`,"i"),mt=B(ce),X=t=>ce.test(t),Nr=[9,10,16],Qe=new RegExp(`^[1-9](?:(?:${Nr.map(t=>`\\d{${t-1}}`).join("|")}))$`),pr=new RegExp(`(?:^|\\D)(${Qe.source.slice(1,-1)})(?:$|\\D)`);function Y(t){return Qe.test(t.toString())}var cr=["computer-programming","cs","pixar","nasa","piab-sandbox","computer-science","hour-of-code","math","differential-equations","electrical-engineering","mcat","apchem-topic","chemistry","art-history-basics","biology"],ee=new RegExp(`^https?:\\/\\/(?:(?:www|${dr.join("|")})\\.)?khanacademy\\.(?:${lr.join("|")})\\/(?:${cr.join("|")})\\/[\\w\\d-.~()'!*:@,;]+\\/(${Qe.toString().slice(2,-2)})$`,"i"),yt=B(ee);function ur(t){return ee.test(t)}var we=new RegExp(`^\\/(?:${cr.join("|")})\\/[\\w\\d-.~()'!*:@,;]+\\/\\d+\\/(\\d+)\\.png$`),ft=B(we),Or=[51,54],mr=/^ag5zfmtoYW4tYWNhZGVteXI(?:U|X)CxIKU2NyYXRjaHBhZB(?:i|j)(?=[\w-]*$)(?:.{7}w|.{9}C(?:g|w|A|Q)w)$/,gt=B(mr);function re(t){if(Or.includes(t.length)||!mr.test(t))return!1;try{return atob(Ne(t)),!0}catch{return!1}}var ht=[106,107,108,110,111],yr=/^ag5zfmtoYW4tYWNhZGVteX(?:I|J)(?:A|B|7|9|-|_)CxIIVXNlckRhdGEi(?:Gm|GG|G2|Hm|HG|HW)thaWRf(?:M|N|O)(?:\w{34}|\w{29,31}|\w{27})(?:LEghGZWVkYmFjaxiAg[I-P](?:O|P|W|X|2|3)|DAsSCEZlZWRiYWNrGICA|MCxIIRmVlZGJhY2sYgI(?:C|D)|wLEghGZWVkYmFjaxiAg|DAsSCEZlZWRiYWNrGICA)(?:[\w-]{5}|[\w-]{7,8})(?:M|DA|C(?:g|w|A|Q)w)$/,bt=B(yr),R=t=>yr.test(t),kt=[301],fr=/^kaencrypted_[a-z0-9]{32}_[a-z0-9]{256}$/,_t=B(fr),I=t=>fr.test(t),Re=/^http:\/\/googleid\.khanacademy\.org\/(\d+)$/,wt=B(Re),gr=t=>Re.test(t),Pe=/^_gae_bingo_random:(\w+-\w+-\w+)$/,Rt=B(Pe),hr=t=>Pe.test(t),br=/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,Pt=B(br),A=t=>br.test(t);var $e;(r=>r.query=`query getFullUserProfile($kaid: String, $username: String) {
  user(kaid: $kaid, username: $username) {
    id
    kaid
    key
    userId
    email
    username
    profileRoot
    gaUserId
    qualarooId
    isPhantom
    isDeveloper: hasPermission(name: "can_do_what_only_admins_can_do")
    isCurator: hasPermission(name: "can_curate_tags", scope: ANY_ON_CURRENT_LOCALE)
    isCreator: hasPermission(name: "has_creator_role", scope: ANY_ON_CURRENT_LOCALE)
    isPublisher: hasPermission(name: "can_publish", scope: ANY_ON_CURRENT_LOCALE)
    isModerator: hasPermission(name: "can_moderate_users", scope: GLOBAL)
    isParent
    isTeacher
    isDataCollectible
    isChild
    isOrphan
    isCoachingLoggedInUser
    canModifyCoaches
    nickname
    hideVisual
    joined
    points
    countVideosCompleted
    bio
    profile {
      accessLevel
      __typename
    }
    soundOn
    muteVideos
    showCaptions
    prefersReducedMotion
    noColorInVideos
    newNotificationCount
    canHellban: hasPermission(name: "can_ban_users", scope: GLOBAL)
    canMessageUsers: hasPermission(name: "can_send_moderator_messages", scope: GLOBAL)
    isSelf: isActor
    hasStudents: hasCoachees
    hasClasses
    hasChildren
    hasCoach
    badgeCounts
    homepageUrl
    isMidsignupPhantom
    includesDistrictOwnedData
    canAccessDistrictsHomepage
    preferredKaLocale {
      id
      kaLocale
      status
      __typename
    }
    underAgeGate {
      parentEmail
      daysUntilCutoff
      approvalGivenAt
      __typename
    }
    authEmails
    signupDataIfUnverified {
      email
      emailBounced
      __typename
    }
    pendingEmailVerifications {
      email
      __typename
    }
    tosAccepted
    shouldShowAgeCheck
    birthMonthYear
    lastLoginCountry
    __typename
  }
  actorIsImpersonatingUser
  isAIGuideEnabled
  hasAccessToAIGuideDev
}
`)($e||($e={}));function Se(t,r){return k(`${b}/getFullUserProfile`,$e.query,typeof t=="string"?_(t)?{kaid:t}:{username:t}:t,r)}var Ge;(r=>r.query=`query getProfileWidgets($kaid: String!) {
  user(kaid: $kaid) {
    id
    kaid
    badgeCounts
    isChild
    profile {
      programs {
        id
        authorKaid
        authorNickname
        deleted
        displayableSpinoffCount
        imagePath
        key
        sumVotesIncremented
        translatedTitle: title
        url
        __typename
      }
      __typename
    }
    programs(sort: TOP, pageInfo: {itemsPerPage: 2}) {
      programs {
        id
        authorKaid
        authorNickname
        deleted
        displayableSpinoffCount
        imagePath
        key
        sumVotesIncremented
        translatedTitle: title
        url
        __typename
      }
      __typename
    }
    __typename
  }
  userSummary(kaid: $kaid) {
    statistics {
      answers
      comments
      flags
      projectanswers
      projectquestions
      questions
      replies
      votes
      __typename
    }
    __typename
  }
}
`)(Ge||(Ge={}));function xe(t,r){return k(`${b}/getProfileWidgets`,Ge.query,typeof t=="string"&&_(t)?{kaid:t}:t,r)}var He;(r=>r.query=`query getUserByUsernameOrEmail($username: String, $email: String) {
  user(username: $username, email: $email) {
    id
    kaid
    __typename
  }
}
`)(He||(He={}));function Ee(t,r){return k(`${b}/getUserByUsernameOrEmail`,He.query,typeof t=="string"?A(t)?{email:t}:{username:t}:t,r)}var je;(r=>r.query=`query getUserHoverCardProfile($kaid: String!) {
  user(kaid: $kaid) {
    id
    nickname
    username
    bio
    avatar {
      name
      imageSrc
      __typename
    }
    points
    isPhantom
    isActor
    isCoachedByActor
    userSummaryIsVisibleToActor
    actorHasUserScopedPermission(capability: CAN_VIEW_USER_IDENTITY)
    __typename
  }
}
`)(je||(je={}));function Ie(t,r){return k(`${b}/getUserHoverCardProfile`,je.query,typeof t=="string"?{kaid:t}:t,r)}var We;(r=>r.query=`query programQuery($programId: String!) {
  programById(id: $programId) {
    byChild
    category
    created
    creatorProfile: author {
      id
      nickname
      profileRoot
      profile {
        accessLevel
        __typename
      }
      __typename
    }
    deleted
    description
    spinoffCount: displayableSpinoffCount
    docsUrlPath
    flags
    flaggedBy: flaggedByKaids
    flaggedByUser: isFlaggedByCurrentUser
    height
    hideFromHotlist
    id
    imagePath
    isProjectOrFork: originIsProject
    isOwner
    kaid: authorKaid
    key
    newUrlPath
    originScratchpad: originProgram {
      deleted
      translatedTitle
      url
      __typename
    }
    restrictPosting
    revision: latestRevision {
      id
      code
      configVersion
      created
      editorType
      folds
      __typename
    }
    slug
    sumVotesIncremented
    title
    topic: parentCurationNode {
      id
      nodeSlug: slug
      relativeUrl
      slug
      translatedTitle
      __typename
    }
    translatedTitle
    url
    userAuthoredContentType
    upVoted
    width
    __typename
  }
}
`)(We||(We={}));function Ae(t,r){return k(`${b}/programQuery`,We.query,typeof t=="number"?{programId:t.toString()}:typeof t=="string"?{programId:t}:t,r)}var Ye;(r=>r.query=`query projectsAuthoredByUser($kaid: String, $pageInfo: ListProgramsPageInfo, $sort: ListProgramSortOrder) {
  user(kaid: $kaid) {
    id
    programs(pageInfo: $pageInfo, sort: $sort) {
      complete
      cursor
      programs {
        id
        key
        authorKaid
        authorNickname
        displayableSpinoffCount
        imagePath
        sumVotesIncremented
        translatedTitle: title
        url
        __typename
      }
      __typename
    }
    __typename
  }
}
`)(Ye||(Ye={}));function Ue(t,r){return k(`${b}/projectsAuthoredByUser`,Ye.query,t,r)}var Je;(r=>r.query=`query QAExpandKeyInfo($encryptedKey: String) {
  qaExpandKeyInfo(encryptedQaExpandKey: $encryptedKey) {
    feedbackType
    unencryptedKey
    __typename
  }
}
`)(Je||(Je={}));function ve(t,r){return k(`${b}/QAExpandKeyInfo`,Je.query,typeof t=="string"?{encryptedKey:t}:t,r)}var _r={};sr(_r,{LoginWithPasswordMutation:()=>te,loginWithPasswordMutation:()=>Ke});var te;(e=>{e.query=`mutation loginWithPasswordMutation($identifier: String!, $password: String!) {
  loginWithPassword(identifier: $identifier, password: $password) {
    user {
      id
      kaid
      canAccessDistrictsHomepage
      isTeacher
      hasUnresolvedInvitations
      transferAuthToken
      preferredKaLocale {
        id
        kaLocale
        status
        __typename
      }
      __typename
    }
    isFirstLogin
    error {
      code
      __typename
    }
    __typename
  }
}
`;let r;(i=>(i.INVALID_CREDENTIALS="INVALID_CREDENTIALS",i.TOO_MANY_ATTEMPTS="TOO_MANY_ATTEMPTS"))(r=e.ErrorCode||(e.ErrorCode={}))})(te||(te={}));function Ke(t,r){return k(`${b}/loginWithPasswordMutation`,te.query,t,{headers:{"x-ka-fkey":ir,Cookie:`fkey=${ir}`},...r})}var $=class{constructor(r,e){return r instanceof u?this.client=r:e??(e=r),e&&this.copy(e),this}copy(r){return Object.assign(this,r),this}copyFromSchema(r){return this.rawData={...this.rawData,...r},this.copy(this.transformSchema(r))}isSchema(r){return this.is(this.transformSchema(r))}};var Qr=(r=>(r.DOWNSTREAM_SERVICE_ERROR="DOWNSTREAM_SERVICE_ERROR",r))(Qr||{}),$r=(r=>(r.users="users",r))($r||{}),Gr=(e=>(e.COACH="COACH",e.PUBLIC="PUBLIC",e))(Gr||{}),wr=(s=>(s.pjs="pjs",s.webpage="webpage",s.ace_sql="ace_sql",s.unknown="",s))(wr||{}),ze=(i=>(i.Challenge="Challenge",i.Interactive="Interactive",i.Project="Project",i.Scratchpad="Scratchpad",i.Talkthrough="Talkthrough",i))(ze||{}),Te=(h=>(h.ALL_PROJECT_ANSWER="ALL_PROJECT_ANSWER",h.ALL_PROJECT_QUESTION="ALL_PROJECT_QUESTION",h.ANSWER="ANSWER",h.COMMENT="COMMENT",h.PROGRAM="PROGRAM",h.PROJECTFEEDBACK="PROJECTFEEDBACK",h.PROJECT_CRITIQUE_ANSWER="PROJECT_CRITIQUE_ANSWER",h.PROJECT_CRITIQUE_QUESTION="PROJECT_CRITIQUE_QUESTION",h.PROJECT_EVAL_ANSWER="PROJECT_EVAL_ANSWER",h.PROJECT_EVAL_QUESTION="PROJECT_EVAL_QUESTION",h.PROJECT_HELP_ANSWER="PROJECT_HELP_ANSWER",h.PROJECT_HELP_QUESTION="PROJECT_HELP_QUESTION",h.QUESTION="QUESTION",h.REPLY="REPLY",h.SUGGESTED_CLARIFICATION="SUGGESTED_CLARIFICATION",h))(Te||{}),Hr=(s=>(s.AnswerFeedback="AnswerFeedback",s.BasicFeedback="BasicFeedback",s.LowQualityFeedback="LowQualityFeedback",s.QuestionFeedback="QuestionFeedback",s))(Hr||{}),Rr=(e=>(e[e.TopVoted=1]="TopVoted",e[e.Recent=2]="Recent",e))(Rr||{}),Pr=(e=>(e.TOP="TOP",e.RECENT="RECENT",e))(Pr||{});var J,ue,Ze=class extends ${constructor(){super(...arguments);K(this,J)}get url(){return this.kaid?`https://www.khanacademy.org/profile/${this.username??this.kaid}`:null}static fromSchema(e){let a=new Ze;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){return new Ze({kaid:_(e)?e:void 0,username:!_(e)&&!A(e)?e:void 0,email:A(e)?e:void 0})}transformSchema(e){return{emails:e.authEmails??void 0,badgeCounts:e.badgeCounts?JSON.parse(e.badgeCounts):void 0,bio:e.bio??void 0,canAccessDistrictsHomepage:e.canAccessDistrictsHomepage??void 0,canHellban:e.canHellban??void 0,canMessageUsers:e.canMessageUsers??void 0,canModifyCoaches:e.canModifyCoaches??void 0,completedVideos:e.countVideosCompleted,email:e.email??void 0,hasChildren:e.hasChildren??void 0,hasClasses:e.hasClasses??void 0,hasCoach:e.hasCoach??void 0,hasStudents:e.hasStudents??void 0,child:e.isChild??void 0,creator:e.isCreator??void 0,curator:e.isCurator??void 0,developer:e.isDeveloper??void 0,midsignupPhantom:e.isMidsignupPhantom??void 0,moderator:e.isModerator??void 0,orphan:e.isOrphan??void 0,parent:e.isParent??void 0,phantom:e.isPhantom??void 0,publisher:e.isPublisher??void 0,self:e.isSelf??void 0,teacher:e.isTeacher??void 0,joined:e.joined?new Date(e.joined):void 0,kaid:typeof e.kaid=="string"&&_(e.kaid)?e.kaid:typeof e.kaid=="string"?null:void 0,key:e.key??void 0,newNotifications:e.newNotificationCount??void 0,nickname:e.nickname??void 0,points:e.points??void 0,accessLevel:e.profile?.accessLevel,googleID:typeof e.userId=="string"&&gr(e.userId)?e.userId.match(Re)[1]:typeof e.userId=="string"?null:void 0,qualarooID:typeof e.qualarooId=="string"&&hr(e.qualarooId)?e.qualarooId.match(Pe)[1]:typeof e.qualarooId=="string"?null:void 0,username:e.username??(e.profileRoot?_(e.profileRoot.slice(9,-1))?null:e.profileRoot.slice(9,-1):e.username)}}async get(e=this.client??new u){let a=await e.getUser(f(this,J,ue).call(this));return this.copy(a)}async getAvatar(e=this.client??new u){let a=await e.getAvatar(f(this,J,ue).call(this));return this.copy({avatar:a}),a}async getStatistics(e=this.client??new u){let a=await e.getUserStatistics(f(this,J,ue).call(this));return this.copy({statistics:a})}async*getPrograms(e=this.client??new u,a,s){for await(let i of e.getUserPrograms(f(this,J,ue).call(this),a,s))this.programs||this.copy({programs:[]}),i.forEach(d=>this.programs?.push(d)),yield i;return this}async getAllPrograms(e=this.client??new u,a,s){let i=await e.getAllUserPrograms(f(this,J,ue).call(this),a,s);return this.copy({programs:i})}is(e){return!(this.kaid&&e.kaid)&&!(this.email&&e.email)&&!(this.key&&e.key)&&!(this.username&&e.username)&&!(this.googleID&&e.googleID)&&!(this.qualarooID&&e.qualarooID)?(console.warn("Users don't have any identifiers that can be compared"),!1):this.kaid&&e.kaid&&this.kaid===e.kaid||this.email&&e.email&&this.email===e.email||this.key&&e.key&&this.key===e.key||this.username&&e.username&&this.username===e.username||this.googleID&&e.googleID&&this.googleID===e.googleID||this.qualarooID&&e.qualarooID&&this.qualarooID===e.qualarooID||!1}},D=Ze;J=new WeakSet,ue=function(){if(this.kaid)return this.kaid;if(this.username)return this.username;if(this.email)return this.email;throw new Error("User has no identifier")};function jr(t){return"data"in t&&!("errors"in t)}function Wr(t){return"errors"in t&&Array.isArray(t.errors)&&"data"in t}function Yr(t){return"errors"in t&&Array.isArray(t.errors)&&!("data"in t)}function S(t){if(Wr(t))throw new Error("Expected data response but got service errors response: "+t.errors.map(r=>r.message).join(", "));if(Yr(t))throw new Error("Expected data response but got input errors response: "+t.errors.map(r=>r.message).join(", "));if(!jr(t))throw new Error("Expected data response but got unknown response")}function Sr(t){if(!re(t))throw new Error("Invalid program key");let r=atob(Ne(t)).split("").map(s=>s.charCodeAt(0)),e=r[17];if(e===20)r=r.slice(32,37);else if(e===23)r=r.slice(34,40);else throw new Error(`Unknown program key version: ${e}`);let a=0n;for(let s=0;s<r.length;s++)a|=BigInt(r[s]&127)<<BigInt(s*7);return Number(e===20?a:a<<14n)}function St(t){if(!Y(t))throw new Error("Invalid program ID");typeof t=="string"&&(t=parseInt(t));let r=t.toString(2).match(/.{1,7}(?=(.{7})*$)/g).map(a=>String.fromCharCode(parseInt(a.length===7?`1${a}`:a,2))).reverse().join(""),e=btoa(`js~khan-academyr${r.length===5?"":""}\v
Scratchpad${r}\f`);return e=Vr(e),e}async function Xe(t){if(_(t))return t;if(X(t)){let s=t.match(ce);if(!s)throw new Error("Invalid user URL");if(t=s[1],_(t))return t}let e=await(await Ee(t)).json();if(S(e),!e.data.user)throw new Error("User not found");let a=e.data.user.kaid;if(!_(a))throw new Error("Invalid KAID");return a}async function xr(t){if(!_(t)&&!A(t)&&!X(t))return t;if(X(t)){let a=t.match(ce);if(!a)throw new Error("Invalid user URL");if(t=a[1],!_(t)&&!A(t))return t}_(t)||(t=await Xe(t));let e=await(await Ie(t)).json();if(S(e),!e.data.user)throw new Error("User not found");return e.data.user.username}function me(t){if(typeof t=="number"){if(!Y(t))throw new Error("Invalid program ID");return t}else if(ur(t)){let r=t.match(ee)[1];if(!Y(r))throw new Error("Invalid program URL");return parseInt(r,10)}else if(re(t)){if(t=Sr(t),!Y(t))throw new Error("Invalid program key");return t}else if(typeof t=="string"){if(!Y(t))throw new Error("Invalid program ID");return parseInt(t,10)}throw new Error("Invalid program identifier")}async function Er(t){if(R(t))return t;if(!I(t))throw new Error("Invalid encrypted message key");let e=await(await ve(t)).json();if(S(e),!e.data.qaExpandKeyInfo)throw new Error("Message key not found");return e.data.qaExpandKeyInfo.unencryptedKey}var Ir=(s=>(s.ProcessingJS="pjs",s.HTML="webpage",s.SQL="ace_sql",s.Other="",s))(Ir||{}),H,ae,G=class extends ${constructor(){super(...arguments);K(this,H)}get spinoff(){return typeof this.origin<"u"?!!this.origin:null}get lines(){return this.code?this.code.split(`
`).length:null}get url(){return this.rawData?.url?`https://www.khanacademy.org${this.rawData.url}`:this.id?`https://www.khanacademy.org/computer-programming/-/${this.id}`:null}get shortUrl(){return this.id?`https://khanacademy.org/cs/-/${this.id}`:null}get thumbnailUrl(){return this.rawData?.imagePath?`https://www.khanacademy.org${this.rawData.imagePath}`:this.thumbnailID&&this.url?`${this.url}/${this.thumbnailID}.png`:null}static fromSchema(e){let a=new G;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){let a=me(e);return new G({id:a,key:typeof e=="string"&&re(e)?e:void 0})}transformSchema(e){return{id:e.id?parseInt(e.id,10):void 0,title:e.translatedTitle,author:e.authorKaid||e.authorNickname||e.creatorProfile?D.fromSchema({kaid:e.authorKaid,nickname:e.authorNickname,isChild:e.byChild??void 0,...e.creatorProfile}):void 0,created:(()=>{if(e.created)return e.revision?.created?new Date(Math.min(new Date(e.created).valueOf(),new Date(e.revision.created).valueOf())):new Date(e.created)})(),updated:(()=>{if(e.revision?.created)return e.created&&e.revision.created===e.created?null:new Date(e.revision.created)})(),width:e.width,height:e.height,votes:e.sumVotesIncremented,spinOffCount:e.spinoffCount??e.displayableSpinoffCount,code:e.revision?.code,hidden:e.hideFromHotlist,type:(()=>{switch(e.revision?.editorType){case"pjs":return G.Type.ProcessingJS;case"webpage":return G.Type.HTML;case"ace_sql":return G.Type.SQL;default:return G.Type.Other}})(),origin:(()=>{if(!e.originScratchpad)return e.originScratchpad;let a=("https://khanacademy.org"+e.originScratchpad.url).match(ee)?.[1];if(!a){console.error(`Failed to parse origin program ID from URL: ${e.originScratchpad.url}`);return}return new G({id:parseInt(a,10),title:e.originScratchpad.translatedTitle,deleted:e.originScratchpad.deleted})})(),key:e.key,thumbnailID:e.imagePath&&we.test(e.imagePath)?parseInt(e.imagePath.match(we)[1],10):void 0,description:typeof e.description=="string"?e.description!==""?e.description:null:e.description,deleted:e.deleted??void 0,selfFlagged:e.flaggedByUser,selfVoted:e.upVoted}}async get(e=this.client??new u){if(!this.id&&!this.key)throw new Error("Program is missing ID and key");let a=await e.getProgram(this.id??this.key);return this.copy(a)}async*getTipsAndThanks(e=this.client??new u,a){for await(let s of e.getProgramTipsAndThanks(f(this,H,ae).call(this),a))this.tipsAndThanks||this.copy({tipsAndThanks:[]}),s.forEach(i=>this.tipsAndThanks?.push(i)),yield s;return this}async getAllTipsAndThanks(e=this.client??new u,a){let s=await e.getAllProgramTipsAndThanks(f(this,H,ae).call(this),a);return this.copy({tipsAndThanks:s})}async*getQuestions(e=this.client??new u,a){for await(let s of e.getProgramQuestions(f(this,H,ae).call(this),a))this.questions||this.copy({questions:[]}),s.forEach(i=>this.questions.push(i)),yield s;return this}async getAllQuestions(e=this.client??new u,a){let s=await e.getAllProgramQuestions(f(this,H,ae).call(this),a);return this.copy({questions:s})}async*getHelpRequests(e=this.client??new u,a){for await(let s of e.getProgramHelpRequests(f(this,H,ae).call(this),a))this.helpRequests||this.copy({helpRequests:[]}),s.forEach(i=>this.helpRequests.push(i)),yield s;return this}async getAllHelpRequests(e=this.client??new u,a){let s=await e.getAllProgramHelpRequests(f(this,H,ae).call(this),a);return this.copy({helpRequests:s})}is(e){return!(this.id&&e.id)&&!(this.key&&e.key)?(console.warn("Programs don't have any identifiers that can be compared"),!1):this.id&&e.id&&this.id===e.id||this.key&&e.key&&this.key===e.key||!1}},T=G;H=new WeakSet,ae=function(){if(this.id)return this.id;if(this.key)return this.key;throw new Error("Program has no identifier")},T.Type=Ir;var Ar=["blobby_green_style","blobby_yellow_style","blobby_blue_style","blobby_purple_style","area_52_yellow_style","area_52_blue_style","area_52_green_style","area_52_purple_style","eggleston_blue_style","eggleston_yellow_style","eggleston_green_style","eggleston_orange_style","scuttlebug_purple_style","scuttlebug_yellow_style","scuttlebug_blue_style","scuttlebug_green_style","boggle_yellow_style","boggle_blue_style","boggle_green_style","boggle_purple_style","sneak_peak_green_style","sneak_peak_yellow_style","sneak_peak_blue_style","sneak_peak_purple_style","stelly_blue_style","stelly_yellow_style","stelly_green_style","stelly_orange_style","cacteye_purple_style","cacteye_yellow_style","cacteye_blue_style","cacteye_green_style","leaf_green_style","leaf_blue_style","leaf_grey_style","leaf_red_style","leaf_orange_style","leaf_yellow_style","leafers_seed_style","leafers_seedling_style","leafers_sapling_style","leafers_tree_style","leafers_ultimate_style","piceratops_seed_style","piceratops_seedling_style","piceratops_sapling_style","piceratops_tree_style","piceratops_ultimate_style","duskpin_seed_style","duskpin_seedling_style","duskpin_sapling_style","duskpin_tree_style","duskpin_ultimate_style","primosaur_seed_style","primosaur_seedling_style","primosaur_sapling_style","primosaur_tree_style","primosaur_ultimate_style","starky_seed_style","starky_seedling_style","starky_sapling_style","starky_tree_style","starky_ultimate_style","aqualine_seed_style","aqualine_seedling_style","aqualine_sapling_style","aqualine_tree_style","aqualine_ultimate_style","spunky_sam_blue_style","spunky_sam_green_style","spunky_sam_orange_style","spunky_sam_red_style","marcimus_pink_style","marcimus_orange_style","marcimus_red_style","marcimus_purple_style","mr_pink_red_style","mr_pink_green_style","mr_pink_orange_style","female_robot_amelia_style","female_robot_ada_style","female_robot_grace_style","male_robot_johnny_style","male_robot_donald_style","male_robot_hal_style","orange_juice_squid_orange_style","purple_pi_purple_style","purple_pi_pink_style","purple_pi_teal_style","mr_pants_teal_style","mr_pants_green_style","mr_pants_orange_style","mr_pants_pink_style","mr_pants_purple_style","old_spice_man_green_style","old_spice_man_blue_style","winston_default_style","winston_baby_style","ohnoes_default_style","hopper_happy_style","hopper_jumping_style","hopper_cool_style"],Ur=["blobby-green","blobby-yellow","blobby-blue","blobby-purple","area-52-yellow","area-52-blue","area-52-green","area-52-purple","eggleston-blue","eggleston-yellow","eggleston-green","eggleston-orange","scuttlebug-purple","scuttlebug-yellow","scuttlebug-blue","scuttlebug-green","boggle-yellow","boggle-blue","boggle-green","boggle-purple","sneak-peak-green","sneak-peak-yellow","sneak-peak-blue","sneak-peak-purple","stelly-blue","stelly-yellow","stelly-green","stelly-orange","cacteye-purple","cacteye-yellow","cacteye-blue","cacteye-green","leaf-green","leaf-blue","leaf-grey","leaf-red","leaf-orange","leaf-yellow","leafers-seed","leafers-seedling","leafers-sapling","leafers-tree","leafers-ultimate","piceratops-seed","piceratops-seedling","piceratops-sapling","piceratops-tree","piceratops-ultimate","duskpin-seed","duskpin-seedling","duskpin-sapling","duskpin-tree","duskpin-ultimate","primosaur-seed","primosaur-seedling","primosaur-sapling","primosaur-tree","primosaur-ultimate","starky-seed","starky-seedling","starky-sapling","starky-tree","starky-ultimate","aqualine-seed","aqualine-seedling","aqualine-sapling","aqualine-tree","aqualine-ultimate","spunky-sam","spunky-sam-green","spunky-sam-orange","spunky-sam-red","marcimus","marcimus-orange","marcimus-red","marcimus-purple","mr-pink","mr-pink-green","mr-pink-orange","robot_female_1","robot_female_2","robot_female_3","robot_male_1","robot_male_2","robot_male_3","orange-juice-squid","purple-pi","purple-pi-pink","purple-pi-teal","mr-pants","mr-pants-green","mr-pants-orange","mr-pants-pink","mr-pants-purple","old-spice-man","old-spice-man-blue","cs-winston","cs-winston-baby","cs-ohnoes","cs-hopper-happy","cs-hopper-jumping","cs-hopper-cool"];function xt(t){return Ur[Ar.indexOf(t)]}function Et(t){return Ar[Ur.indexOf(t)]}function er(t){return`https://www.khanacademy.org/images/avatars/svg/${t}.svg`}function rr(t){return`https://www.khanacademy.org/images/avatars/${t}.png`}function Ce(t){return t.match(/^(?:https:\/\/www\.khanacademy\.org)?\/images\/avatars(?:\/svg)?\/(.*)\.(?:(?:svg)|(?:png))$/)?.[1]??null}function It(t){let r=Ce(t);return r?rr(r):null}function At(t){let r=Ce(t);return r?er(r):null}function Jr(t){return t.replace(/[a-zA-Z]+, \d\d [A-Za-z0-9]+ \d{4} \d\d:\d\d:\d\d [a-zA-Z]+/g,"").replace(/; (Path|Expires|Max-Age|HttpOnly|Secure|SameSite)[^;,]*/g,"").replace(/,/g,";")}var j=class extends ${get bySelf(){return this.client?.user?this.byUser(this.client.user):!1}transformSchema(e){return{text:e.content,author:e.author&&D.fromSchema(e.author),program:(()=>{if(e.focus?.kind==="Scratchpad")return new T({id:typeof e.focus.id=="string"?parseInt(e.focus.id,10):void 0,title:e.focus.translatedTitle});if(e.focusUrl){let a=e.focusUrl.match(pr);return!a||a.length<1?void 0:new T({id:parseInt(a[1],10)})}})(),created:e.date?new Date(e.date):void 0,key:e.expandKey,encryptedKey:e.key,deleted:e.appearsAsDeleted,locked:e.isLocked,verified:e.definitelyNotSpam,score:e.lowQualityScore,byVideoAuthor:e.fromVideoAuthor,selfFlagged:e.flaggedByUser}}byUser(e){return this.author?this.author.is(e):!1}is(e){return!(this.key&&e.key)&&!(this.encryptedKey&&e.encryptedKey)?(console.warn("Messages don't have any identifiers that can be compared"),!1):this.key&&e.key&&this.key===e.key||this.encryptedKey&&e.encryptedKey&&this.encryptedKey===e.encryptedKey||!1}};var oe=(a=>(a[a.TipsAndThanks="COMMENT"]="TipsAndThanks",a[a.Question="QUESTION"]="Question",a[a.HelpRequest="PROJECT_HELP_QUESTION"]="HelpRequest",a))(oe||{}),tr=class extends j{get selfVoted(){return this.client?.authenticated===!1?null:this.selfUpvoted?1:this.selfDownvoted?-1:0}static fromSchema(e){let a=new tr;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){return new tr({key:R(e)?e:void 0,encryptedKey:I(e)?e:void 0})}transformSchema(e){return{...super.transformSchema(e),votes:e.sumVotesIncremented,replyCount:e.replyCount,selfUpvoted:e.upVoted,selfDownvoted:e.downVoted}}copy(e){return super.copy(e)}async get(e=this.client??new u){if(!this.key&&!this.encryptedKey)throw new Error("Message does not have a key or encrypted key");let a=await e.getMessage(this.key??this.encryptedKey);return this.copy(a)}async getAllReplies(e=this.client??new u){if(!this.key&&!this.encryptedKey)throw new Error("Message does not have a key or encrypted key");let a=await e.getAllMessageReplies(this.key??this.encryptedKey);return this.copy({replies:a})}},g=tr;g.Type=oe;var V=class extends g{static fromSchema(e){let a=new V;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){return new V({key:R(e)?e:void 0,encryptedKey:I(e)?e:void 0})}transformSchema(e){return{...super.transformSchema(e),question:e.question?x.fromSchema(e.question):void 0}}copy(e){return super.copy(e)}};var x=class extends g{static fromSchema(e){let a=new x;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){return new x({key:R(e)?e:void 0,encryptedKey:I(e)?e:void 0})}transformSchema(e){return{...super.transformSchema(e),answerCount:e.answerCount,old:e.isOld,answers:(()=>{if(!e.answers)return;let a=e.answers.map(s=>V.fromSchema(s));return a.forEach(s=>s.copy({question:this})),a})()}}copy(e){return super.copy(e)}};var L=class extends j{static fromSchema(e){let a=new L;return a.copyFromSchema(e),a.rawData=e,a}static fromIdentifier(e){return new L({key:R(e)?e:void 0,encryptedKey:I(e)?e:void 0})}transformSchema(e){return{...super.transformSchema(e),message:(()=>{if(!(typeof e.replyExpandKeys>"u")){if(typeof e.replyExpandKeys=="string"&&R(e.replyExpandKeys))return new g({key:e.replyExpandKeys});if(Array.isArray(e.replyExpandKeys))return new g({key:e.replyExpandKeys[0]})}})()}}copy(e){return super.copy(e)}copyFromSchema(e){return super.copyFromSchema(e)}async get(e=this.client??new u){if(!this.key&&!this.encryptedKey)throw new Error("Message does not have a key or encrypted key");let a=await e.getMessage(this.key??this.encryptedKey);return this.copy(a)}};var C=class extends g{static fromSchema(r){let e=new C;return e.copyFromSchema(r),e.rawData=r,e}static fromIdentifier(r){return new C({key:R(r)?r:void 0,encryptedKey:I(r)?r:void 0})}transformSchema(r){return{...super.transformSchema(r),votes:r.sumVotesIncremented,replyCount:r.replyCount,selfUpvoted:r.upVoted,selfDownvoted:r.downVoted}}copy(r){return super.copy(r)}};function vr(t){return t.feedbackType==="COMMENT"}function Ut(t){return t.feedbackType==="REPLY"}function Kr(t){return t.feedbackType==="QUESTION"}function vt(t){return t.feedbackType==="ANSWER"}var Tr={[oe.TipsAndThanks]:C,[oe.Question]:x,[oe.HelpRequest]:x};var W,se,ne,N,ye,fe,U,q,F=class{constructor(){K(this,W,void 0);K(this,se,void 0);K(this,ne,void 0);K(this,N,new Map);K(this,ye,new Map);K(this,fe,new Map);this.authenticated=!1;this.kaid=null;return this}async resolveCachedKaid(r){if(_(r))return r;if(m(this,N).has(r))return m(this,N).get(r);let e=await Xe(r);return m(this,N).set(r,e),e}async resolveCachedUsername(r){if(!_(r)&&!A(r)&&!X(r))return r;if(m(this,ye).has(r))return m(this,ye).get(r);let e=await xr(r);return m(this,ye).set(r,e),e}async resolveCachedFeedbackKey(r){if(R(r))return r;if(m(this,fe).has(r))return m(this,fe).get(r);let e=await Er(r);return m(this,fe).set(r,e),e}get kaas(){return!this.authenticated||!m(this,ne)?null:m(this,ne).match(/KAAS=([^;]+)/)?.[1]??null}async login(r,e){var d;if(r&&(_(r)&&(r=await this.resolveCachedUsername(r)),Le(this,W,r)),e&&Le(this,se,e),!m(this,W)||!m(this,se))throw m(this,W)?m(this,se)?new Error("Missing username/email and password"):new Error("Missing password"):new Error("Missing username or email");let a=await Ke({identifier:m(this,W),password:m(this,se)},{credentials:"include"}),s=await f(d=F,U,q).call(d,a);if(S(s),!s.data.loginWithPassword)throw new Error("Malformed response");if(s.data.loginWithPassword.error)switch(s.data.loginWithPassword.error.code){case te.ErrorCode.INVALID_CREDENTIALS:throw new Error("Invalid Credentials error: Check your username/email and password");case te.ErrorCode.TOO_MANY_ATTEMPTS:throw new Error("Too Many Attempts error: Rate-limited by Khan Academy");default:throw new Error("Unknown error code: "+s.data.loginWithPassword.error.code)}let i=a.headers.get("set-cookie");if(!i)throw new Error("No cookies returned: Something went wrong on Khan Academy's end");return Le(this,ne,Jr(i)),this.authenticated=!0,this.kaid=typeof s.data.loginWithPassword.user?.kaid=="string"&&_(s.data.loginWithPassword.user.kaid)?s.data.loginWithPassword.user.kaid:null,this.kaid===null&&console.warn(`User ${r??this.kaas??"unknown"} does not have a valid KAID`),s.data.loginWithPassword}async getUser(r){var d;if(!r&&!this.authenticated)throw new Error("Not authenticated: You need to login or provide an indentifier");let e=null;r&&(A(r)&&(e=r),r=await this.resolveCachedKaid(r));let a=await Se(r,r?void 0:{credentials:"include",headers:{cookie:m(this,ne)}}),s=await f(d=F,U,q).call(d,a);if(S(s),!s.data.user)throw new Error("User not found");let i=D.fromSchema(s.data.user);return i.client=this,!i.email&&e&&A(e)&&i.copy({email:e}),i.self&&(this.user=i),i.kaid&&(i.username&&!m(this,N).has(i.username)&&m(this,N).set(i.username,i.kaid),i.email&&!m(this,N).has(i.email)&&m(this,N).set(i.email,i.kaid)),i}async getAvatar(r=this.kaid??m(this,W),e="svg"){var d;if(!r)throw new Error("No identifier provided");r=await this.resolveCachedKaid(r);let a=await _e(r),s=await f(d=F,U,q).call(d,a);if(S(s),!s.data.user)throw new Error("User not found");let i=Ce(s.data.user.avatar.imageSrc);if(!i)throw new Error("User has no avatar");return e==="svg"?er(i):rr(i)}async getUserStatistics(r=this.kaid??m(this,W)){var s;if(!r)throw new Error("No identifier provided");r=await this.resolveCachedKaid(r);let e=await xe(r),a=await f(s=F,U,q).call(s,e);if(S(a),!a.data.user)throw new Error("User not found");return{votes:a.data.userSummary.statistics.votes,tipsAndThanks:a.data.userSummary.statistics.comments,questions:a.data.userSummary.statistics.questions,answers:a.data.userSummary.statistics.answers,helpRequests:a.data.userSummary.statistics.projectquestions,helpRequestAnswers:a.data.userSummary.statistics.projectanswers,replies:a.data.userSummary.statistics.replies,flags:a.data.userSummary.statistics.flags}}async*getUserPrograms(r,e="TOP",a=40){if(!r&&!this.authenticated)throw new Error("Not authenticated: You need to login or provide an indentifier");if(r??(r=this.kaid??this.user?.username??this.user?.email),!r)throw new Error("Missing identifier for logged in user");let i={kaid:await this.resolveCachedKaid(r),pageInfo:{cursor:null,itemsPerPage:a},sort:e},d=async O=>{var h;let p=await Ue({...i,pageInfo:{...i.pageInfo,cursor:O}}),v=await f(h=F,U,q).call(h,p);if(S(v),!v.data.user)throw new Error("User not found");if(!v.data.user.programs.complete&&!v.data.user.programs.cursor)throw new Error("Cursor not found");let he=v.data.user.programs.programs.map(z=>{let be=T.fromSchema(z);return be.client=this,be}),ie=!v.data.user.programs.complete&&v.data.user.programs.cursor;return{programs:he,cursor:ie}},{programs:y,cursor:E}=await d();for(yield y;E;)({programs:y,cursor:E}=await d(E)),yield y}async getAllUserPrograms(r,e="TOP",a=100){let s=[];for await(let i of this.getUserPrograms(r,e,a))s.push(...i);return s}async getProgram(r){var i;r=me(r);let e=await Ae(r),a=await f(i=F,U,q).call(i,e);if(S(a),!a.data.programById)throw new Error("Program not found");let s=T.fromSchema(a.data.programById);return s.client=this,this.user&&s.author?.kaid===this.kaid&&(s.copy({author:this.user}),console.debug(`Copied the client's user data to program ${s.title?`"${Br(s.title,32)}"`:s.id??"unknown"} because the program's author matches the client user`)),s}async getMessage(r){var d;R(r)||(r=await this.resolveCachedFeedbackKey(r));let e=await de({topicId:Fr.toString(),focusKind:"Scratchpad",feedbackType:"COMMENT",currentSort:1,qaExpandKey:r}),a=await f(d=F,U,q).call(d,e);if(S(a),!a.data.feedback||!a.data.feedback.feedback||a.data.feedback.feedback.length===0)throw new Error("Message not found");let s=a.data.feedback.feedback[0],i;if(vr(s))i=C.fromSchema(s);else if(Kr(s)){let y=x.fromSchema(s);if(y.key!==r){let E=y.answers?.find(O=>O.key===r);if(!E)throw new Error("Question or answer not found");i=E,i.copy({question:y})}else i=y}else throw new Error("Unknown message type");return i.client=this,this.user&&i.author?.kaid===this.kaid&&(i.copy({author:this.user}),console.debug(`Copied the client's user data to comment ${i.key??i.encryptedKey??"unknown"} because the comment's author matches the client user`)),i}async getTipsAndThanks(r){return this.getMessage(r)}async getQuestion(r){return this.getMessage(r)}async getAnswer(r){return this.getMessage(r)}async getReply(r){var y;let e=await this.getMessage(r);if(!e.key)throw new Error("Message has no key");let a=await pe(e.key),s=await f(y=F,U,q).call(y,a);if(S(s),!s.data.feedbackReplies||s.data.feedbackReplies.length===0)throw new Error("Reply not found");let i=s.data.feedbackReplies.find(E=>E.expandKey===r||E.key===r);if(!i)throw new Error("Reply not found");let d=L.fromSchema(i);return d.client=this,d.copy({message:e}),this.user&&d.author?.kaid===this.kaid&&(d.copy({author:this.user}),console.debug(`Copied the client's user data to reply ${d.key??d.encryptedKey??"unknown"} because the reply's author matches the client user`)),d}async*getProgramMessages(r=g.Type.TipsAndThanks,e,a=1){e=me(e);let s={topicId:e.toString(),focusKind:"Scratchpad",feedbackType:r,currentSort:a},i=async E=>{var ie;let O=await de({...s,cursor:E}),p=await f(ie=F,U,q).call(ie,O);if(S(p),!p.data.feedback.feedback)throw new Error("Comments not found");if(!p.data.feedback.isComplete&&!p.data.feedback.cursor)throw new Error("Cursor not found");let ge=p.data.feedback.feedback.map(h=>{let z=Tr[r].fromSchema(h);return z.client=this,z}),he=!p.data.feedback.isComplete&&p.data.feedback.cursor;return{messages:ge,cursor:he}},{messages:d,cursor:y}=await i();for(yield d;y;)({messages:d,cursor:y}=await i(y)),yield d}async getAllProgramMessages(r=g.Type.TipsAndThanks,e,a=1){let s=[];for await(let i of this.getProgramMessages(r,e,a))s.push(...i);return s}async*getProgramTipsAndThanks(r,e=1){yield*this.getProgramMessages(g.Type.TipsAndThanks,r,e)}async getAllProgramTipsAndThanks(r,e=1){return this.getAllProgramMessages(g.Type.TipsAndThanks,r,e)}async*getProgramQuestions(r,e=1){yield*this.getProgramMessages(g.Type.Question,r,e)}async getAllProgramQuestions(r,e=1){return this.getAllProgramMessages(g.Type.Question,r,e)}async*getProgramHelpRequests(r,e=1){yield*this.getProgramMessages(g.Type.HelpRequest,r,e)}async getAllProgramHelpRequests(r,e=1){return this.getAllProgramMessages(g.Type.HelpRequest,r,e)}async getAllMessageReplies(r){var i;r=await this.resolveCachedFeedbackKey(r);let e=await pe(r),a=await f(i=F,U,q).call(i,e);if(S(a),!a.data.feedbackReplies)throw new Error("Replies not found");return a.data.feedbackReplies.map(d=>{let y=L.fromSchema(d);return y.client=this,y})}},u=F;W=new WeakMap,se=new WeakMap,ne=new WeakMap,N=new WeakMap,ye=new WeakMap,fe=new WeakMap,U=new WeakSet,q=async function(r){try{return await r.json()}catch(e){let a=e instanceof Error?e.message:typeof e=="string"?e:"Unknown error";throw new Error(`Failed to parse response JSON: ${a}`)}},K(u,U);return dt(Kt);})();
//# sourceMappingURL=khan-api.min.js.map
